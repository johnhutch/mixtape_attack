<% @page_title = @review.album.artist.name + " - " + @review.album.name %>

<div id="review">
	<div class="type">Album Review</div>	
	
	<%= image_tag @review.album.art.url(:featured), :id => "art" %>
	<div id="scores"><em>Rating:</em> <%= @review.decimal_score %></div>

	<h2><strong><%= link_to @review.album.name, album_path(@review.album) %></strong>
		<em>by</em>
		<%= link_to @review.album.artist.name, artist_path(@review.album.artist) %>
	</h2>	
	
	<div id="date">Released <%= @review.album.release_date.strftime('%B %e, %Y') %></div>
	<div id="label"><%= link_to @review.album.label.name, @review.album.label rescue nil %></div>
	<div class="genres">
		<% i = 1 %>
		<% for tag in @review.album.tags %>
			<%= link_to tag, genre_album_path(tag.name) %>
			<%= "&bull" unless i == @review.album.tags.count %>
			<% i = i+1 %>
		<% end %>
	</div>
	<div id="body">
		<%= @review.body %>
	</div>
	
	<div id="byline">Reviewed by <%= link_to @review.user.name, @review.user %></div>
</div>

<div id="comments">
	<h2>Comments</h2>
	<% if @review.comments.blank? %>
		<p>This review has no comments</p>
	<% end %>
	
	<% for comment in @review.comments do %>
		<div class="comment <%= cycle("even", "odd") %>">
			<div class="byline"><%= time_ago_in_words(comment.created_at) %> ago, <%= comment.user.name %> said:</div>
			<div class="body"><%= comment.body %></div>
		</div>
	<% end %>
	
<%= render :partial => 'shared/comment_form', :locals => {:type => "review"} unless ! logged_in? %>
</div>

<% content_for :contextual do %>
	<h2 id="other_info">Other Info</h2>
	<%= other_albums(@review.album) unless @review.album.artist.albums.count.to_i < 2 %>

	<%= other_reviews(@review.user) unless @review.user.reviews.count.to_i < 2 %>
<% end %>